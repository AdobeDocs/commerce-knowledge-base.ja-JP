---
title: カテゴリへの変更が保存されない
description: この記事では、Commerce管理者を使用して商品カテゴリをアップデートする際に、管理者およびストアフロントに変更内容が表示されないようにする方法について説明します。 問題は、「catalog_category_entity」テーブル内の破損したデータが原因です。 この問題を解決するには、テーブル内の問題のあるカテゴリ更新レコードを修正または削除します。 その後、管理者を使用して製品カテゴリを更新できるようになります。
exl-id: d951205c-add9-478c-9c7d-2ba975d53b14
feature: Categories
role: Developer
source-git-commit: 1d2e0c1b4a8e3d79a362500ee3ec7bde84a6ce0d
workflow-type: tm+mt
source-wordcount: '721'
ht-degree: 0%

---

# カテゴリへの変更が保存されない

この記事では、Commerce管理者を使用して商品カテゴリをアップデートする際に、管理者およびストアフロントに変更内容が表示されないようにする方法について説明します。 問題の原因は、のデータが破損しているためです `catalog_category_entity` テーブル。 この問題を解決するには、テーブル内の問題のあるカテゴリ更新レコードを修正または削除します。 その後、管理者を使用して製品カテゴリを更新できるようになります。

## 問題

管理者で製品カテゴリに変更を加えて保存すると、新しい更新は保存されず、管理およびストアフロントにも表示されません。

### 再現手順

1. に移動 **カタログ** > **カテゴリ**.
1. カテゴリを選択します。
1. 変更を加え、をクリックします。 **保存**.
1. メッセージが表示されます。 *カテゴリが保存されました*.
1. 行った変更は保存されていません。

## 原因：のデータが破損しています `catalog_category_entity` テーブル

この問題は、内の同じ値によって発生します。 `created_in` データベース（DB）内の該当するカテゴリレコードの列。

![catalog_category_entity テーブルの破損したデータ](assets/catalog_category_entity.png)

詳細：

* この `catalog_category_entity` DB テーブルには、影響を受けるカテゴリの複数のレコードがあります（これらのレコードは同じです） `entity_id` 値）。
* これらのカテゴリ レコードには **内の同じ値 `created_in` 列**.

### 2 つ目の DB エントリ（および次に続くすべての DB エントリ）は、同じカテゴリに対してどのように DB に表示されますか？

影響を受けるカテゴリの 2 つ目の DB レコード（場合によっては次のレコード）は、Category\_Staging モジュールを使用してMagentoの更新がスケジュールされていることを意味します。 モジュールは、カテゴリの追加レコードを `catalog_category_entity` これは想定されるアプリケーション動作です。問題は、レコードの値が以下と同じであることです。 `created_in` 列。

### 同じ値はどのように表示されますか？

データ破損の理由を確実に述べることはできません。 考えられる理由は次のとおりです。

* カスタマイズ（コード、テーマなど）
* 誤ったデータ移行
* バックアップからの誤ったデータ復元

私たちの知る限り、このようなデータ破損は、（標準の）「クリーンな」Adobe Commerce インスタンスでは一般的ではなく、カスタマイズを行わずにAdobe Commerce インストールで再現することはできません。

### これが問題であることを確認する方法

この `catalog_category_entity` テーブルには、影響を受けるカテゴリの複数のレコードが必要です（レコードは同じにする必要があります） `entity_id` 値）を指定し、それらのレコードのうち、少なくとも 2 つのレコードに同じ値を設定する必要があります `created_in` 値。 これにより、ステージングスケジュールされた更新はCommerce管理者に表示されず、空の「スケジュールされた変更」ブロックのみが表示されます。

#### 検証の手順

1. データベースの catalog\_category\_entity テーブルにアクセスします。
1. entity\_id でエンティティをフィルタリングします。entity\_id は影響を受けるカテゴリを識別します。
1. 同じ entity\_id を持つ異なるエントリに対して created\_in カラムの値が同じ場合は、この例になります。 通常、は `created_in` 値はレコードごとに異なります。

![catalog_category_entity テーブルの破損したデータ](assets/catalog_category_entity.png)

## 解決策

次のいずれかのソリューションを選択できます。

1. **削除** 問題のあるカテゴリ更新レコード
1. **修理** 問題のあるカテゴリ更新レコード

### 問題のあるカテゴリ更新レコードを削除します

この解決策では、正しいを設定する必要があります `updated_in` 最初のカテゴリ レコードの値で、このカテゴリの他のすべてのレコードを削除します。 これにより、スケジュールされたすべてのカテゴリの更新が削除されます。

次の手順に従います。

1. で DB レコードを検索します。 `entity_id` （影響を受けるカテゴリ）。
1. で最大の整数を持つレコードを選択 `updated_in` 列。
1. をコピーします `updated_in` 選択したレコードの値。
1. を使用してレコードを選択 `row_id` = `entity_id` （初期カテゴリレコード）をコピーし、コピーした値を `updated_in` このレコードの列。
1. 行を削除 `row_id` 次と等しくない `entity_id` .

### 問題のあるカテゴリ更新レコードの修復

1. 同じカテゴリ レコードの検索 `entity_id` 同じ `created_in` の値。
1. 次の条件でレコードを選択 `row_id` = `entity_id` をコピーします `updated_in` の値。
1. 次の条件でレコードを選択 `row_id` 次と等しくない `entity_id` コピーしたを貼り付けます `updated_in` の値 `created_in` の値。 以下のスクリーンショットを図として参照してください。    ![created_in value.png のコピー](assets/copy_created-in_value.png)
1. カテゴリがレコードを更新することを確認します `created_in` （手順 3 で）更新した値が `staging_update` テーブル。 *例：* コピーした場合 `created_in` 値は 1509281953 で、次を持つエンティティです `row_id` =に 1509281953 が存在する必要があります `staging_update` テーブル
